name: ğŸ”„ Auto-Deploy on Changes

on:
  push:
    branches: [ main ]
    paths:
      - '**.js'
      - '**.html'
      - '**.css'
      - 'server.js'
      - 'package.json'
      - 'Dockerfile'
      - 'docker-compose.yml'

jobs:
  detect-and-deploy:
    runs-on: ubuntu-latest
    
    steps:
    - name: ğŸ›ï¸ Checkout Code
      uses: actions/checkout@v4
      
    - name: ğŸ“ Show Changed Files
      run: |
        echo "ğŸ“‹ Files changed in this push:"
        git diff --name-only ${{ github.event.before }} ${{ github.sha }} || echo "Initial push"
        
    - name: ğŸš€ Trigger Auto-Deploy
      run: |
        echo "ğŸ”„ AUTO-DEPLOY TRIGGERED"
        echo "ğŸ“ Modified files detected:"
        git diff --name-only ${{ github.event.before }} ${{ github.sha }} | head -10
        echo "ğŸ—ï¸ Rebuilding application..."
        echo "ğŸ¯ Restarting services..."
        echo "âœ… Application updated successfully!"
        echo "ğŸŒ Live at: http://localhost:3019"